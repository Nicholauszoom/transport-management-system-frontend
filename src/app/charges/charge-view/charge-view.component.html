<app-main-layout>
  <div id="product-view" class="flex justify-content-center">
    <p-card>
      <ng-template pTemplate="header">
        <div class="flex align-items-center gap-2">
          <h2 class="m-0"><i class="pi pi-tag text-primary" style="font-size: 2rem;"></i>  Charge Details</h2>
        </div>
      </ng-template>

      <ng-container *ngIf="charge; else loadingOrEmpty">
        <p-tabView>

          <!-- Employee Info -->
          <p-tabPanel header="Employee Information">
            <div class="p-fluid grid">
              <div class="col-12 md:col-4">
                <strong>Check Number:</strong>
                <p>{{ charge.checkNumber || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Designation Code:</strong>
                <p>{{ charge.designationCode || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Designation Name:</strong>
                <p>{{ charge.designationName || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Job Class Code:</strong>
                <p>{{ charge.jobClassCode || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Vote Code:</strong>
                <p>{{ charge.voteCode || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Terms of Employment:</strong>
                <p>{{ charge.termsOfEmployment || 'N/A' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Retirement Date:</strong>
                <p>{{ charge.retirementDate || 'N/A' }}</p>
              </div>
            </div>
          </p-tabPanel>

          <!-- Salary Info -->
          <p-tabPanel header="Salary Information">
            <div class="p-fluid grid">
              <div class="col-12 md:col-4">
                <strong>Basic Salary:</strong>
                <p>{{ charge.basicSalary | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Net Salary:</strong>
                <p>{{ charge.netSalary | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>One Third Amount:</strong>
                <p>{{ charge.oneThirdAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Employee Deduction:</strong>
                <p>{{ charge.totalEmployeeDeduction | currency:'Tsh ' }}</p>
              </div>
            </div>
          </p-tabPanel>

          <!-- Charge Request Info -->
          <p-tabPanel header="Charge Request">
            <div class="p-fluid grid">
              <div class="col-12 md:col-4">
                <strong>Requested Amount:</strong>
                <p>{{ charge.requestedAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Desired Deductible Amount:</strong>
                <p>{{ charge.desiredDeductibleAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Deductible Amount:</strong>
                <p>{{ charge.deductibleAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Tenure:</strong>
                <p>{{ charge.tenure }} months</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Product Code:</strong>
                <p>{{ charge.productCode || 'N/A' }}</p>
              </div>
            </div>
          </p-tabPanel>

          <!-- Charges & Calculations -->
          <p-tabPanel header="Charge Calculations">
            <div class="p-fluid grid">
              <div class="col-12 md:col-4">
                <strong>Net Loan Amount:</strong>
                <p>{{ charge.netLoanAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Take Home Amount:</strong>
                <p>{{ charge.takeHomeAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Amount To Pay:</strong>
                <p>{{ charge.totalAmountToPay | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Interest Amount:</strong>
                <p>{{ charge.totalInterestRateAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Insurance Amount:</strong>
                <p>{{ charge.totalInsurance | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Processing Fees:</strong>
                <p>{{ charge.totalProcessingFee | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Other Charges Amount:</strong>
                <p>{{ charge.otherCharges | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Deductable Amount(/Monthly):</strong>
                <p>{{ charge.monthlyReturnAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Tenure:</strong>
                <p>{{ charge.responseTenure }}</p>
              </div>
            </div>
          </p-tabPanel>

          <!-- Charge Response -->
          <p-tabPanel header="Charge Response">
            <div class="p-fluid grid">
              <div class="col-12 md:col-4">
                <strong>Desired Deductible Amount:</strong>
                <p>{{ charge.monthlyReturnAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Insurance:</strong>
                <p>{{ charge.insuranceProcessFee | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Processing Fees:</strong>
                <p>{{ 0 | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Interest Rate Amount:</strong>
                <p>{{ charge.totalInterestRateAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Other Charges:</strong>
                <p>{{ charge.otherCharges | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Net Loan Amount:</strong>
                <p>{{ charge.netLoanAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Total Amount To Pay:</strong>
                <p>{{ charge.totalAmountToPay | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Tenure:</strong>
                <p>{{ charge.responseTenure }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Eligible Amount:</strong>
                <p>{{ charge.eligibleAmount | currency:'Tsh ' }}</p>
              </div>
              <div class="col-12 md:col-4">
                <strong>Monthly Return Amount:</strong>
                <p>{{ charge.monthlyReturnAmount | currency:'Tsh ' }}</p>
              </div>
            </div>
          </p-tabPanel>

           <!-- Meta Data -->
          <p-tabPanel header="Meta Data">
            <div class="p-fluid grid">
              <div class="col-12">
                <strong>Created Date:</strong>
                <p>{{ charge.createdDate }}</p>
              </div>
            </div>
          </p-tabPanel>

        </p-tabView>

        <div class="mt-4">
          <p-button 
            label="Delete Charge" 
            icon="pi pi-trash" 
            severity="danger" 
            (click)="deleteCharge(charge.id)" />
        </div>
      </ng-container>

      <ng-template #loadingOrEmpty>
        <div class="text-center">
          <p *ngIf="inProgress" class="text-primary">
            <i class="pi pi-spin pi-spinner"></i> Loading charges details...
          </p>
          <p *ngIf="!inProgress" class="text-secondary">No charges data available.</p>
        </div>
      </ng-template>
    </p-card>
  </div>
</app-main-layout>
