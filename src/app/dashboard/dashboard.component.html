<app-main-layout>
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="dashboard-title">
          <i class="pi pi-chart-line"></i>
          Dashboard Overview
        </h1>
        <p class="dashboard-subtitle">Monitor your mandate performance and system metrics</p>
      </div>
    </div>
    
    <!-- Quick Stats Banner -->
    <div class="quick-stats-banner">
      <div class="stat-highlight">
        <span class="stat-number">{{ getTotalValue() | currency:'TSH ':'symbol':'1.0-0' }}</span>
        <span class="stat-label">Total Value</span>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Cards Grid -->
  <div class="dashboard-grid">
    <!-- Total Users Card -->
    <div class="dashboard-card users-card">
      <div class="card-header">
        <div class="card-icon users-icon">
          <i class="pi pi-users"></i>
        </div>
        <div class="card-trend positive">
          <i class="pi pi-arrow-up"></i>
          <span>+12.5%</span>
        </div>
      </div>
      
      <div class="card-body">
        <h3 class="card-title">Total Users</h3>
        <div class="card-number">{{ totalUsers | number }}</div>
        <p class="card-subtitle">Active system users</p>
        
        <div class="card-progress">
          <div class="progress-bar">
            <div class="progress-fill users-progress" style="width: 75%"></div>
          </div>
          <span class="progress-text">75% of target</span>
        </div>
      </div>
      
      <div class="card-footer">
        <span class="footer-text">
          <i class="pi pi-calendar"></i>
          Updated today
        </span>
        <p-button 
          icon="pi pi-arrow-right" 
          severity="info" 
          text="true" 
          size="small"
          (click)="navigateToUsers()"
        />
      </div>
    </div>

    <!-- Total Mandates Card -->
    <div class="dashboard-card mandates-card">
      <div class="card-header">
        <div class="card-icon mandates-icon">
          <i class="pi pi-file-text"></i>
        </div>
        <div class="card-trend positive">
          <i class="pi pi-arrow-up"></i>
          <span>+8.3%</span>
        </div>
      </div>
      
      <div class="card-body">
        <h3 class="card-title">Total Mandates</h3>
        <div class="card-number">{{ totalProducts | number }}</div>
        <p class="card-subtitle">All mandate requests</p>
        
        <div class="card-chart">
          <div class="mini-chart">
            <div class="chart-bar" style="height: 20%"></div>
            <div class="chart-bar" style="height: 45%"></div>
            <div class="chart-bar" style="height: 80%"></div>
            <div class="chart-bar" style="height: 65%"></div>
            <div class="chart-bar" style="height: 90%"></div>
            <div class="chart-bar" style="height: 75%"></div>
            <div class="chart-bar" style="height: 100%"></div>
          </div>
        </div>
      </div>
      
      <div class="card-footer">
        <span class="footer-text">
          <i class="pi pi-clock"></i>
          Last 7 days
        </span>
        <p-button 
          icon="pi pi-arrow-right" 
          severity="success" 
          text="true" 
          size="small"
          (click)="navigateToMandates()"
        />
      </div>
    </div>

    <!-- Success Mandates Card -->
    <div class="dashboard-card success-card">
      <div class="card-header">
        <div class="card-icon success-icon">
          <i class="pi pi-check-circle"></i>
        </div>
        <div class="card-trend positive">
          <i class="pi pi-arrow-up"></i>
          <span>+15.7%</span>
        </div>
      </div>
      
      <div class="card-body">
        <h3 class="card-title">Success Mandates</h3>
        <div class="card-number">{{ totalLoans | number }}</div>
        <p class="card-subtitle">Successfully processed</p>
        
        <div class="card-donut">
          <div class="donut-chart">
            <div class="donut-segment success-segment" style="--percentage: 85"></div>
            <div class="donut-center">
              <span class="donut-percentage">85%</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card-footer">
        <span class="footer-text">
          <i class="pi pi-check"></i>
          Success rate
        </span>
        <p-button 
          icon="pi pi-arrow-right" 
          severity="warning" 
          text="true" 
          size="small"
          (click)="navigateToSuccess()"
        />
      </div>
    </div>

    <!-- Failed Mandates Card -->
    <div class="dashboard-card failed-card">
      <div class="card-header">
        <div class="card-icon failed-icon">
          <i class="pi pi-times-circle"></i>
        </div>
        <div class="card-trend negative">
          <i class="pi pi-arrow-down"></i>
          <span>-5.2%</span>
        </div>
      </div>
      
      <div class="card-body">
        <h3 class="card-title">Failed Mandates</h3>
        <div class="card-number">{{ getFailedCount() | number }}</div>
        <p class="card-subtitle">Requires attention</p>
        
        <div class="card-alert">
          <i class="pi pi-exclamation-triangle"></i>
          <span>{{ getPendingReviewCount() }} pending review</span>
        </div>
      </div>
      
      <div class="card-footer">
        <span class="footer-text">
          <i class="pi pi-exclamation-circle"></i>
          Needs review
        </span>
        <p-button 
          icon="pi pi-arrow-right" 
          severity="danger" 
          text="true" 
          size="small"
          (click)="navigateToFailed()"
        />
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-content">
      <div class="loading-spinner">
        <i class="pi pi-spin pi-spinner"></i>
      </div>
      <p>Loading dashboard data...</p>
    </div>
  </div>
</app-main-layout>